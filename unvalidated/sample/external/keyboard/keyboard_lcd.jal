-- prog.jal, to test LCD

include 16F877a          

pragma target clock 20_000_000                  -- xtal frequency
pragma target OSC        hs
pragma target   LVP disabled
pragma target   WDT disabled

enable_digital_io()


var bit  LED        is pin_a0       -- LED to see proper PIC startup
pin_a0_direction    = output         

var  bit  RS        is pin_b5       -- LCD command/data select.
var  bit  EN        is pin_b4       -- LCD data trigger
var byte data_port  is portb_low    -- LCD data
portb_direction     = all_output    -- LCD data is portb_low
include lcd                         -- LCD library


var volatile byte keyscan  is portd_low  -- rows of keyboard
portd_low_direction         = all_input
var volatile byte keydrive is portd_high -- columns of keyboard
portd_high_direction        = all_output
include keyboard

for 4 loop
   LED = on
   for 10 loop   
      delay100mus(255)
   end loop
   LED = off
   for 10 loop   
      delay100mus(255)
   end loop
end loop

lcdwrtchar("K")  lcdwrtchar("e") lcdwrtchar("y")
lcdwrtchar("b")  lcdwrtchar("o") lcdwrtchar("a")  lcdwrtchar("r") lcdwrtchar("d")
lcdwrtchar(" ")
lcdwrtchar("t")  lcdwrtchar("e") lcdwrtchar("s") lcdwrtchar("t") 


var byte key

forever loop                                  -- loop forever

   lcdSetCursor(1, 0)              -- second line, char 0
   key = getkey()
   lcdWrthexchar(key) 
   for 10 loop   
      delay100mus(200)
   end loop
end loop






