-- -----------------------------------------------------------------------------
-- sample  JALv2: Blink a LED on pin_a0 of a PIC16F877A
-- This demo will blink a LED with a period of 1 second,
-- i.e. 0.5 seconds on, 0.5 seconds off
-- This demo uses the built in delay for the timing
-- -----------------------------------------------------------------------------
-- Tested
--    16F877A, 20 MHz: ok
-- -----------------------------------------------------------------------------


-- -----------------------------------------------------------------------------
-- include hardware definitions
-- select the appropriate devive library
-- -----------------------------------------------------------------------------
include 16f877a  		-- PIC16F877A device file

-- basic hardware settings
pragma target clock       20_000_000
pragma target osc         hs
pragma target lvp	  disabled
pragma target wdt	  disabled


ADCON1 = 0b0000_0111		-- FIXME!

-- -----------------------------------------------------------------------------
-- variable definition and initialisation
-- -----------------------------------------------------------------------------
-- define the io-pin as a logical name
var bit LED is pin_a0
-- and set the io-pin as an output
pin_a0_direction = output

-- define the blink period in units of usec (microseconds = 1/1000 000 seconds)
const byte half_blink_period = 50_000
-- -----------------------------------------------------------------------------


-- -----------------------------------------------------------------------------
-- start of the main program
-- -----------------------------------------------------------------------------
forever loop
  LED = on
  -- wait for half a period
  _usec_delay( half_blink_period )
  LED = off
  _usec_delay( half_blink_period )
end loop


